extends ../layout

block content
  - const formatDate = (dateString) => new Date(dateString).toLocaleString()

  section.ticket
    .ticket__wrapper
      h1.visually-hidden Карточка объявления
      .ticket__content
        .ticket__img
          img(src=`/img/${offer.picture}` alt=offer.title)
        .ticket__info
          h2.ticket__title #{offer.title}
          .ticket__header
            p.ticket__price
              span.js-sum #{offer.sum}
              |  ₽
            p.ticket__action #{offer.type === `buy` ? `КУПЛЮ` : `ПРОДАМ`}
          .ticket__desc
            p #{offer.description}
          .ticket__data
            p
              b Дата добавления:
              span  #{formatDate(offer.pubDate)}
            p
              b Автор:
              a(href=`#!`)  Денис Шкатулкин
            p
              b Контакты:
              a(href=`mailto:shkatulkin@ya.ru`)  shkatulkin@ya.ru
          ul.ticket__tags
            each category in offer.categories
              li
                a.category-tile.category-tile--small(href=`#!`)
                  span.category-tile__image
                    img(src=`/img/${category.picture}`, srcset=`/img/${category.picture.split(`.`)[0]}@2x.jpg 2x`, alt=category.title)
                  span.category-tile__label #{category.title}
      .ticket__comments
        h2.ticket__subtitle Коментарии
        .ticket__comment-form
          form.form.comment-form(action=`/offers/${offer.id}/comments`, method=`post`, enctype=`multipart/form-data`)
            .comment-form__header
              a.comment-form__avatar.avatar(href=`#!`)
                img(src=`/img/avatar.jpg`, srcset=`/img/avatar@2x.jpg 2x`, alt=`Аватар пользователя`)
              p.comment-form__author Вам слово
            .comment-form__field
              .form__field
                textarea#comment-field.js-field(name=`comment`, cols=`30`, rows=`10`, minlength=C.MinValue.COMMENT, maxlength=C.MaxValue.COMMENT, required=``) #{payload.text}
                label(for=`comment-field`) Текст комментария
                span Обязательное поле
              +errorMessage(errors.text)
            button.comment-form__button.btn.btn--white.js-button(type=`submit`, disabled=!payload.text) Отправить
        .ticket__comments-list
          ul.comments-list
            each comment in offer.comments
              li
                .comment-card
                  .comment-card__header
                    a.comment-card__avatar.avatar(href=`#!`)
                      img(src=`/img/avatar02.jpg`, srcset=`/img/avatar02@2x.jpg 2x`, alt=`Аватар пользователя`)
                    p.comment-card__author Георгий Шпиц
                  .comment-card__content
                    p #{comment.text}
